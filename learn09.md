## 第9回課題  

### ライブコーディングを見た所感  

* 第9回のライブコーディングでは、Rails組み込みサーバからNginxとUnicornへ分ける、第5回課題内容の答え合わせでした。  

* NginxとUnicornは同じEC2内に設置していますが、実運用となると、同環境にサーバーを二つ設置するのは、サーバー一つのスペックに依存してしまうということと、大量のトラフィックが必要になる場合には不向きとのことでした。実際の現場では、NginxとUnicornそれぞれにEC2を一台利用するので、今回の課題の環境は易しい、と講師の方が仰っていたので驚きました。基本の形としてこの課題の環境が構築できれば応用が効くそうなので、引き続き学習を頑張りたいと思います。  


* CSSが読み込まれないエラーにて、ライブコーディングでは、config.assets.debug = trueをコメントアウトしていました。私はこのエラーはpermissionエラーとして権限を与えて解決したのですが、構築する上でのエラーの出方、他の受講生の質問を見ていても思うのですが、同じように構築しているようでも人それぞれで様々なエラーが出て、対処法も違うので、どのようなエラーに対しても対処出来る知識や経験が必要だと思いました。  


### ライブコーディングを見て、自分自身で作成した環境との違いなど  


* Nginxの設定時、conf.d配下にアプリ用のファイルを作成し、読み込ませる形で設定をしようとしたのですが上手くいかず、最終的にはnginx.confファイルに設定をまとめたのですが、ライブコーディングではその当初やろうとしていたファイルを分ける設定で構築をしてくださったので、どこが間違えていたのかを振り返りながら確認が出来ました。間違えていた要因としては、途中で設定を変えてしまったので、推測ではありますが、  
「rootで指定先のpublicディレクトリに読み込みの権限が無かった」  
「rootとlocationの指定が間違えていた」  
この2点が原因だったのではと思います。設定ファイルの記述方法を理解するのがとても難しかったので、この設定に一番時間が掛かってしまいました。  

* 起動コマンドが異なったので比べてみるのと同時に、改めてどういう意味なのかを調べてみました。  
  
    * Unicorn

    ***【講師】***  
    ```bundle exec unicorn -c config/unicorn.rb -D -E development```  
    ***【自分】***   
    ```bundle exec unicorn -c config/unicorn.rb -E development -p 8080```


    * NginX  

    ***【講師】***  
    ```sudo systemctl start nginx.service```  
    ***【自分】***  
    ```sudo service nginx start```

Unicornの起動コマンドのオプション「-c」はconfigファイルのパスを指定しているので「config/unicorn.rb」を起動すると宣言しています。「-D」はバックグラウンド（デーモン）で起動するためのもの。「-E」はrailsを表して、development環境で起動する、ということ。
私が指定している「-p 8080」はポート番号を指定して起動していますが、次回からは削除して講師の方の起動コマンドを使用しようと思います。

Nginx起動コマンドに関しては両者ともよく使われている起動コマンドのようです。ただしこの二つのコマンドで大きく異なる点は、「service」はシェルを実行するサービスを管理するコマンドで、対して「systemctl」は独自の設定ファイルを使って実行するコマンドという点です。  
「systemctl」には標準でenableというコマンドが入っていて、どちらも使える状態であればsystemctlを使う方が望ましいそうなので、今度からはこちらも講師の方の起動コマンドを使用することとします。
ちなみに「.service」は入れても入れなくてもよいそうです。  
コマンド一つとっても、「起動出来ればOK」なのだと思っていましたが「より良い」方を選ぶ知識も必要なのだなと感じました。

引き続き学習を深めながら次回の課題へ進みたいと思います。


[参考にしたページ：Linuxのコマンド実行で使うserviceとsystemctlの違いとは何か？](https://code-bug.net/qfr8l41pigu2v05ztwbc/)